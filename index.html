<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8" />
  <title>תחזית כדורגל עם API אמיתי</title>
  <style>
    body { font-family: Arial, sans-serif; direction: rtl; padding: 20px; }
    select, button { padding: 8px; margin: 10px 0; width: 100%; max-width: 400px; }
    #result { margin-top: 20px; font-weight: bold; white-space: pre-line; }
  </style>
</head>
<body>
  <h1>תחזית כדורגל - בחר ליגה וקבוצות</h1>
  
  <label for="leagueSelect">בחר ליגה:</label>
  <select id="leagueSelect">
    <option value="">טוען ליגות...</option>
  </select>

  <label for="team1Select">בחר קבוצה 1:</label>
  <select id="team1Select" disabled>
    <option value="">בחר קודם ליגה</option>
  </select>

  <label for="team2Select">בחר קבוצה 2:</label>
  <select id="team2Select" disabled>
    <option value="">בחר קודם ליגה</option>
  </select>

  <button id="predictBtn" disabled>חשב תחזית</button>

  <div id="result"></div>

  <script>
    const apiKey = "5ce9f8d068bf9962e11d192391618d53"; // המפתח שלך פה
    const leagueSelect = document.getElementById('leagueSelect');
    const team1Select = document.getElementById('team1Select');
    const team2Select = document.getElementById('team2Select');
    const predictBtn = document.getElementById('predictBtn');
    const resultDiv = document.getElementById('result');

    async function loadLeagues() {
      leagueSelect.innerHTML = "<option value=''>טוען ליגות...</option>";
      try {
        const res = await fetch('https://api-football-v1.p.rapidapi.com/v3/leagues', {
          method: 'GET',
          headers: {
            'x-rapidapi-host': 'api-football-v1.p.rapidapi.com',
            'x-rapidapi-key': apiKey
          }
        });
        const data = await res.json();
        if (data.response) {
          // סינון לליגות גדולות כולל ליגת העל הישראלית לפי דוגמא
          const leagues = data.response.filter(l => 
            ['Premier League', 'La Liga', 'Serie A', 'Bundesliga', 'Ligue 1', 'Israeli Premier League'].includes(l.league.name)
          );

          leagueSelect.innerHTML = '<option value="">בחר ליגה</option>';
          leagues.forEach(league => {
            const option = document.createElement('option');
            option.value = league.league.id;
            option.text = league.league.name + " - " + league.country.name;
            leagueSelect.appendChild(option);
          });
        } else {
          leagueSelect.innerHTML = '<option value="">לא נמצאו ליגות</option>';
        }
      } catch (err) {
        console.error(err);
        leagueSelect.innerHTML = '<option value="">שגיאה בטעינת ליגות</option>';
      }
    }

    async function loadTeams(leagueId) {
      team1Select.disabled = true;
      team2Select.disabled = true;
      team1Select.innerHTML = "<option>טוען קבוצות...</option>";
      team2Select.innerHTML = "<option>טוען קבוצות...</option>";
      predictBtn.disabled = true;
      try {
        const res = await fetch(`https://api-football-v1.p.rapidapi.com/v3/teams?league=${leagueId}&season=2023`, {
          method: 'GET',
          headers: {
            'x-rapidapi-host': 'api-football-v1.p.rapidapi.com',
            'x-rapidapi-key': apiKey
          }
        });
        const data = await res.json();
        if (data.response && data.response.length > 0) {
          team1Select.innerHTML = '<option value="">בחר קבוצה 1</option>';
          team2Select.innerHTML = '<option value="">בחר קבוצה 2</option>';
          data.response.forEach(team => {
            const option1 = document.createElement('option');
            option1.value = team.team.id;
            option1.text = team.team.name;
            team1Select.appendChild(option1);

            const option2 = document.createElement('option');
            option2.value = team.team.id;
            option2.text = team.team.name;
            team2Select.appendChild(option2);
          });
          team1Select.disabled = false;
          team2Select.disabled = false;
        } else {
          team1Select.innerHTML = "<option>לא נמצאו קבוצות</option>";
          team2Select.innerHTML = "<option>לא נמצאו קבוצות</option>";
        }
      } catch (err) {
        console.error(err);
        team1Select.innerHTML = "<option>שגיאה בטעינת קבוצות</option>";
        team2Select.innerHTML = "<option>שגיאה בטעינת קבוצות</option>";
      }
    }

    function checkPredictReady() {
      predictBtn.disabled = !(team1Select.value && team2Select.value && team1Select.value !== team2Select.value);
    }

    leagueSelect.addEventListener('change', () => {
      if (leagueSelect.value) {
        loadTeams(leagueSelect.value);
        resultDiv.textContent = "";
      } else {
        team1Select.innerHTML = '<option>בחר קודם ליגה</option>';
        team2Select.innerHTML = '<option>בחר קודם ליגה</option>';
        team1Select.disabled = true;
        team2Select.disabled = true;
        predictBtn.disabled = true;
      }
    });

    team1Select.addEventListener('change', checkPredictReady);
    team2Select.addEventListener('change', checkPredictReady);

    predictBtn.addEventListener('click', () => {
      const team1Name = team1Select.options[team1Select.selectedIndex].text;
      const team2Name = team2Select.options[team2Select.selectedIndex].text;
      // כאן תוכל להוסיף לוגיקה אמיתית או להציג מידע מה-API לפי הקבוצות
      resultDiv.textContent = `תחזית בין:\n${team1Name}\nל-\n${team2Name}\n(כאן תוסיף אלגוריתם אמיתי)`;
    });

    loadLeagues();
  </script>
</body>
</html>
